<project name="Micro-workflow" default="mworkflow" basedir=".">
  <property name="version" value="1.0.8" />	
  <description>
       Micro-workflow package by Dragos Manolescu (dam@micro-workflow.com)
  	   Extended by Nina Jeliazkova nina@acad.bg	
   </description>
  <property name="src" location="src"/>
  <property name="concurrent_src" location="concurrent"/>
  <property name="bin" location="bin"/>
  <property name="dist"  location="dist"/>
  <property name="junit_jar" location="lib/junit.jar"/>

  <target name="init">
    <tstamp/>
    <mkdir dir="${bin}"/>
  </target>

  <target name="compile" depends="concurrent"
        description="compile the source" >
    <javac srcdir="${src}" destdir="${bin}" classpath="${junit_jar}:.${bin}">
	</javac>
  </target>

	<!--
	TODO This package can be replaced by Java 1.5 java.util.concurrent 
	-->
 <target name="concurrent" depends="init" description="compile Doug Lea's concurrent package" >
    <javac srcdir="${concurrent_src}" destdir="${bin}">
	</javac>
  </target>

 <target name="dist"
  	depends="compile"
	description="generate the distribution" >
 <mkdir dir="${dist}"/>
 <tar destfile="${dist}/Micro-workflow.tar.gz" compression="gzip">
	<tarfileset dir="./">
		<exclude name="bin/**"/> <!-- ${bin} expands to absolute path :( -->
		<exclude name="dist/**"/>
		<exclude name="**/pcexample/**"/>
	</tarfileset> 
 </tar>
 </target>

    <!-- mworkflow-version.jar -->
	<target	id="mworkflow" name="mworkflow" depends="compile" description="Compiles mworkflow-vX.X.jar package">
		 <mkdir dir="${dist}"/>
		<jar jarfile="${dist}/mworkflow-${version}.jar" compress="true">
		    <fileset dir="${bin}" includes="**/*" 
			excludes="**/com/microworkflow/test/**"/>

		</jar>
	</target>
	
  <target name="clean"
        description="clean up" >
    <delete dir="${bin}"/>
    <delete dir="${dist}"/>
  </target>
</project>
